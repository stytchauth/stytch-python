# !!!
# WARNING: This file is autogenerated
# Only modify code within MANUAL() sections
# or your changes may be overwritten later!
# !!!

from __future__ import annotations

from typing import List, Optional

import pydantic

from stytch.consumer.models.device_history import DeviceInfo
from stytch.consumer.models.sessions import Session
from stytch.consumer.models.users import User
from stytch.core.response_base import ResponseBase


class TOTP(pydantic.BaseModel):
    """
    Fields:
      - totp_id: The unique identifier for the TOTP (Time-based One-Time Password) registration.
      - verified: A boolean indicating whether this contact method has been successfully authenticated by the User.
      - recovery_codes: The recovery codes used to authenticate the user without an authenticator app.
    """  # noqa

    totp_id: str
    verified: bool
    recovery_codes: List[str]


class AuthenticateResponse(ResponseBase):
    """Response type for `TOTPs.authenticate`.
    Fields:
      - user_id: The unique ID for a User. When making API calls, you may use an `external_id` in place of the `user_id` if one is set for the User.
      - session_token: The `session_token` associated with a User's existing Session.
      - totp_id: The unique identifier for the TOTP (Time-based One-Time Password) registration.
      - session_jwt: The JSON Web Token (JWT) associated with a User's existing Session.
      - user: The `user` object affected by this API call.
      - session: If you initiate a Session, by including `session_duration_minutes` in your authenticate call, you'll receive a full Session object in the response.
      - user_device: If a valid `telemetry_id` was passed in the request and the Fingerprint Lookup API returned results, this field will contain information about the user's device attributes.
    """  # noqa

    user_id: str
    session_token: str
    totp_id: str
    session_jwt: str
    user: User
    session: Optional[Session] = None
    user_device: Optional[DeviceInfo] = None


class CreateResponse(ResponseBase):
    """Response type for `TOTPs.create`.
    Fields:
      - totp_id: The unique identifier for the TOTP (Time-based One-Time Password) registration.
      - secret: The TOTP secret key shared between the authenticator app and the server used to generate TOTP codes.
      - qr_code: A base64-encoded QR code image.
      - recovery_codes: The recovery codes used to authenticate the user without an authenticator app.
      - user: The `user` object affected by this API call.
      - user_id: The unique ID for a User. When making API calls, you may use an `external_id` in place of the `user_id` if one is set for the User.
    """  # noqa

    totp_id: str
    secret: str
    qr_code: str
    recovery_codes: List[str]
    user: User
    user_id: str


class RecoverResponse(ResponseBase):
    """Response type for `TOTPs.recover`.
    Fields:
      - totp_id: The unique identifier for the TOTP (Time-based One-Time Password) registration.
      - user_id: The unique ID for a User. When making API calls, you may use an `external_id` in place of the `user_id` if one is set for the User.
      - session_token: The `session_token` associated with a User's existing Session.
      - session_jwt: The JSON Web Token (JWT) associated with a User's existing Session.
      - user: The `user` object affected by this API call.
      - session: If you initiate a Session, by including `session_duration_minutes` in your authenticate call, you'll receive a full Session object in the response.
      - user_device: If a valid `telemetry_id` was passed in the request and the Fingerprint Lookup API returned results, this field will contain information about the user's device attributes.
    """  # noqa

    totp_id: str
    user_id: str
    session_token: str
    session_jwt: str
    user: User
    session: Optional[Session] = None
    user_device: Optional[DeviceInfo] = None


class RecoveryCodesResponse(ResponseBase):
    """Response type for `TOTPs.recovery_codes`.
    Fields:
      - user_id: The unique ID for a User. When making API calls, you may use an `external_id` in place of the `user_id` if one is set for the User.
      - totps: An array containing a list of all TOTP instances for a given User.
    """  # noqa

    user_id: str
    totps: List[TOTP]

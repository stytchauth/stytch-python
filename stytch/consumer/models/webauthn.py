# !!!
# WARNING: This file is autogenerated
# Only modify code within MANUAL() sections
# or your changes may be overwritten later!
# !!!

from __future__ import annotations

from typing import List, Optional

import pydantic

from stytch.consumer.models.device_history import DeviceInfo
from stytch.consumer.models.sessions import Session
from stytch.consumer.models.users import User, WebAuthnRegistration
from stytch.core.response_base import ResponseBase


class WebAuthnCredential(pydantic.BaseModel):
    """
    Fields:
      - credential_id: The unique identifier for a WebAuthn credential or passkey.
      - webauthn_registration_id: Globally unique UUID that identifies a Passkey or WebAuthn registration in the Stytch API. The `webauthn_registration_id` is used when you need to operate on a specific User's WebAuthn registration.
      - type: The type or category of the resource, method, or entity.
      - public_key: A public cryptographic key (in base64 format) used for signature verification or encryption.
    """  # noqa

    credential_id: str
    webauthn_registration_id: str
    type: str
    public_key: str


class AuthenticateResponse(ResponseBase):
    """Response type for `WebAuthn.authenticate`.
    Fields:
      - user_id: The unique ID for a User. When making API calls, you may use an `external_id` in place of the `user_id` if one is set for the User.
      - webauthn_registration_id: Globally unique UUID that identifies a Passkey or WebAuthn registration in the Stytch API. The `webauthn_registration_id` is used when you need to operate on a specific User's WebAuthn registration.
      - session_token: The `session_token` associated with a User's existing Session.
      - session_jwt: The JSON Web Token (JWT) associated with a User's existing Session.
      - user: The `user` object affected by this API call.
      - session: If you initiate a Session, by including `session_duration_minutes` in your authenticate call, you'll receive a full Session object in the response.
      - user_device: If a valid `telemetry_id` was passed in the request and the Fingerprint Lookup API returned results, this field will contain information about the user's device attributes.
    """  # noqa

    user_id: str
    webauthn_registration_id: str
    session_token: str
    session_jwt: str
    user: User
    session: Optional[Session] = None
    user_device: Optional[DeviceInfo] = None


class AuthenticateStartResponse(ResponseBase):
    """Response type for `WebAuthn.authenticate_start`.
    Fields:
      - user_id: The unique ID for a User. When making API calls, you may use an `external_id` in place of the `user_id` if one is set for the User.
      - public_key_credential_request_options: Credential request options for authenticating with WebAuthn or passkeys.
    """  # noqa

    user_id: str
    public_key_credential_request_options: str


class ListCredentialsResponse(ResponseBase):
    """Response type for `WebAuthn.list_credentials`.
    Fields:
      - credentials: A list of WebAuthn credential objects.
    """  # noqa

    credentials: List[WebAuthnCredential]


class RegisterResponse(ResponseBase):
    """Response type for `WebAuthn.register`.
    Fields:
      - user_id: The unique ID for a User. When making API calls, you may use an `external_id` in place of the `user_id` if one is set for the User.
      - webauthn_registration_id: Globally unique UUID that identifies a Passkey or WebAuthn registration in the Stytch API. The `webauthn_registration_id` is used when you need to operate on a specific User's WebAuthn registration.
      - session_token: The `session_token` associated with a User's existing Session.
      - session_jwt: The JSON Web Token (JWT) associated with a User's existing Session.
      - user: The `user` object affected by this API call.
      - session: If you initiate a Session, by including `session_duration_minutes` in your authenticate call, you'll receive a full Session object in the response.
      - user_device: If a valid `telemetry_id` was passed in the request and the Fingerprint Lookup API returned results, this field will contain information about the user's device attributes.
    """  # noqa

    user_id: str
    webauthn_registration_id: str
    session_token: str
    session_jwt: str
    user: User
    session: Optional[Session] = None
    user_device: Optional[DeviceInfo] = None


class RegisterStartResponse(ResponseBase):
    """Response type for `WebAuthn.register_start`.
    Fields:
      - user_id: The unique ID for a User. When making API calls, you may use an `external_id` in place of the `user_id` if one is set for the User.
      - public_key_credential_creation_options: Options used for Passkey or WebAuthn registration.
    """  # noqa

    user_id: str
    public_key_credential_creation_options: str


class UpdateResponse(ResponseBase):
    """Response type for `WebAuthn.update`.
    Fields:
      - webauthn_registration: A Passkey or WebAuthn registration.
    """  # noqa

    webauthn_registration: Optional[WebAuthnRegistration] = None

# !!!
# WARNING: This file is autogenerated
# Only modify code within MANUAL() sections
# or your changes may be overwritten later!
# !!!

from __future__ import annotations

import datetime
from typing import List, Optional

import pydantic

from stytch.consumer.models.device_history import DeviceInfo
from stytch.consumer.models.sessions import Session
from stytch.consumer.models.users import User
from stytch.core.response_base import ResponseBase


class ProviderValues(pydantic.BaseModel):
    """
    Fields:
      - access_token: The `access_token` that you may use to access the User's data in the provider's API.
      - refresh_token: The `refresh_token` that you may use to obtain a new `access_token` for the User within the provider's API.
      - id_token: The `id_token` returned by the OAuth provider. ID Tokens are JWTs that contain structured information about a user. The exact content of each ID Token varies from provider to provider. ID Tokens are returned from OAuth providers that conform to the OpenID Connect specification, which is based on OAuth
      - scopes: The OAuth scopes included for a given provider.
      - expires_at: The timestamp indicating when the session, token, lock, or other resource will expire.
    """  # noqa

    access_token: str
    refresh_token: str
    id_token: str
    scopes: List[str]
    expires_at: Optional[datetime.datetime] = None


class AttachResponse(ResponseBase):
    """Response type for `OAuth.attach`.
    Fields:
      - oauth_attach_token: A single-use token for connecting the Stytch User selection from an OAuth Attach request to the corresponding OAuth Start request.
    """  # noqa

    oauth_attach_token: str


class AuthenticateResponse(ResponseBase):
    """Response type for `OAuth.authenticate`.
    Fields:
      - user_id: The unique ID for a User. When making API calls, you may use an `external_id` in place of the `user_id` if one is set for the User.
      - provider_subject: The unique identifier for the User within a given OAuth provider. Also commonly called the "sub" or "Subject field" in OAuth protocols.
      - provider_type: The type of OAuth provider (e.g., google, microsoft, slack, github, hubspot) used for authentication.
      - session_token: The `session_token` associated with a User's existing Session.
      - session_jwt: The JSON Web Token (JWT) associated with a User's existing Session.
      - provider_values: Values or configuration settings specific to an identity provider.
      - user: The `user` object affected by this API call.
      - reset_sessions: Indicates if all other of the User's Sessions need to be reset. You should check this field if you aren't using Stytch's Session product. If you are using Stytch's Session product, we revoke the User's other sessions for you.
      - oauth_user_registration_id: The unique identifier for the OAuth provider registration linking the user to their provider account.
      - user_session: A session object for consumer (B2C) users.
      - user_device: If a valid `telemetry_id` was passed in the request and the Fingerprint Lookup API returned results, this field will contain information about the user's device attributes.
    """  # noqa

    user_id: str
    provider_subject: str
    provider_type: str
    session_token: str
    session_jwt: str
    provider_values: ProviderValues
    user: User
    reset_sessions: bool
    oauth_user_registration_id: str
    user_session: Optional[Session] = None
    user_device: Optional[DeviceInfo] = None

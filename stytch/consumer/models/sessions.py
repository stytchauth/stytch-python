# !!!
# WARNING: This file is autogenerated
# Only modify code within MANUAL() sections
# or your changes may be overwritten later!
# !!!

from __future__ import annotations

import datetime
import enum
from typing import Any, Dict, List, Optional

import pydantic

from stytch.consumer.models.attribute import Attributes
from stytch.consumer.models.device_history import DeviceInfo
from stytch.consumer.models.users import User
from stytch.core.response_base import ResponseBase


class AuthenticationFactorDeliveryMethod(str, enum.Enum):
    EMAIL = "email"
    SMS = "sms"
    WHATSAPP = "whatsapp"
    EMBEDDED = "embedded"
    OAUTH_GOOGLE = "oauth_google"
    OAUTH_MICROSOFT = "oauth_microsoft"
    OAUTH_APPLE = "oauth_apple"
    WEBAUTHN_REGISTRATION = "webauthn_registration"
    AUTHENTICATOR_APP = "authenticator_app"
    OAUTH_GITHUB = "oauth_github"
    RECOVERY_CODE = "recovery_code"
    OAUTH_FACEBOOK = "oauth_facebook"
    CRYPTO_WALLET = "crypto_wallet"
    OAUTH_AMAZON = "oauth_amazon"
    OAUTH_BITBUCKET = "oauth_bitbucket"
    OAUTH_COINBASE = "oauth_coinbase"
    OAUTH_DISCORD = "oauth_discord"
    OAUTH_FIGMA = "oauth_figma"
    OAUTH_GITLAB = "oauth_gitlab"
    OAUTH_INSTAGRAM = "oauth_instagram"
    OAUTH_LINKEDIN = "oauth_linkedin"
    OAUTH_SHOPIFY = "oauth_shopify"
    OAUTH_SLACK = "oauth_slack"
    OAUTH_SNAPCHAT = "oauth_snapchat"
    OAUTH_SPOTIFY = "oauth_spotify"
    OAUTH_STEAM = "oauth_steam"
    OAUTH_TIKTOK = "oauth_tiktok"
    OAUTH_TWITCH = "oauth_twitch"
    OAUTH_TWITTER = "oauth_twitter"
    KNOWLEDGE = "knowledge"
    BIOMETRIC = "biometric"
    SSO_SAML = "sso_saml"
    SSO_OIDC = "sso_oidc"
    OAUTH_SALESFORCE = "oauth_salesforce"
    OAUTH_YAHOO = "oauth_yahoo"
    OAUTH_HUBSPOT = "oauth_hubspot"
    IMPORTED_AUTH0 = "imported_auth0"
    OAUTH_EXCHANGE_SLACK = "oauth_exchange_slack"
    OAUTH_EXCHANGE_HUBSPOT = "oauth_exchange_hubspot"
    OAUTH_EXCHANGE_GITHUB = "oauth_exchange_github"
    OAUTH_EXCHANGE_GOOGLE = "oauth_exchange_google"
    IMPERSONATION = "impersonation"
    OAUTH_ACCESS_TOKEN_EXCHANGE = "oauth_access_token_exchange"
    TRUSTED_TOKEN_EXCHANGE = "trusted_token_exchange"


class AuthenticationFactorType(str, enum.Enum):
    MAGIC_LINK = "magic_link"
    OTP = "otp"
    OAUTH = "oauth"
    WEBAUTHN = "webauthn"
    TOTP = "totp"
    CRYPTO = "crypto"
    PASSWORD = "password"
    SIGNATURE_CHALLENGE = "signature_challenge"
    SSO = "sso"
    IMPORTED = "imported"
    RECOVERY_CODES = "recovery_codes"
    EMAIL_OTP = "email_otp"
    IMPERSONATED = "impersonated"
    TRUSTED_AUTH_TOKEN = "trusted_auth_token"


class AmazonOAuthFactor(pydantic.BaseModel):
    """
    Fields:
      - id: The unique identifier for the resource.
      - provider_subject: The unique identifier for the user in the identity provider's system, used to link external provider accounts to Stytch members.
      - email_id: The unique ID of a specific email address.
    """  # noqa

    id: str
    provider_subject: str
    email_id: Optional[str] = None


class AppleOAuthFactor(pydantic.BaseModel):
    """
    Fields:
      - id: The unique identifier for the resource.
      - provider_subject: The unique identifier for the user in the identity provider's system, used to link external provider accounts to Stytch members.
      - email_id: The unique ID of a specific email address.
    """  # noqa

    id: str
    provider_subject: str
    email_id: Optional[str] = None


class AuthenticatorAppFactor(pydantic.BaseModel):
    """
    Fields:
      - totp_id: The unique identifier for the TOTP (Time-based One-Time Password) registration.
    """  # noqa

    totp_id: str


class AuthorizationCheck(pydantic.BaseModel):
    """
    Fields:
      - resource_id: The identifier of a specific resource within an RBAC authorization check.
      - action: An RBAC action that defines what operation is being performed on a resource (e.g., read, write, delete).
    """  # noqa

    resource_id: str
    action: str


class AuthorizationVerdict(pydantic.BaseModel):
    """
    Fields:
      - authorized: Whether the actor was authorized to perform the specified action on the specified Resource. Always true if the request succeeds.
      - granting_roles: The complete list of Roles that gave the Member permission to perform the specified action on the specified Resource.
    """  # noqa

    authorized: bool
    granting_roles: List[str]


class BiometricFactor(pydantic.BaseModel):
    """
    Fields:
      - biometric_registration_id: The `biometric_registration_id` to be deleted.
    """  # noqa

    biometric_registration_id: str


class BitbucketOAuthFactor(pydantic.BaseModel):
    """
    Fields:
      - id: The unique identifier for the resource.
      - provider_subject: The unique identifier for the user in the identity provider's system, used to link external provider accounts to Stytch members.
      - email_id: The unique ID of a specific email address.
    """  # noqa

    id: str
    provider_subject: str
    email_id: Optional[str] = None


class CoinbaseOAuthFactor(pydantic.BaseModel):
    """
    Fields:
      - id: The unique identifier for the resource.
      - provider_subject: The unique identifier for the user in the identity provider's system, used to link external provider accounts to Stytch members.
      - email_id: The unique ID of a specific email address.
    """  # noqa

    id: str
    provider_subject: str
    email_id: Optional[str] = None


class CryptoWalletFactor(pydantic.BaseModel):
    """
    Fields:
      - crypto_wallet_id: The unique identifier for a cryptocurrency wallet registration.
      - crypto_wallet_address: The blockchain address of the cryptocurrency wallet used for Web3 authentication.
      - crypto_wallet_type: The type of wallet to authenticate. Currently `ethereum` and `solana` are supported. Wallets for any EVM-compatible chains (such as Polygon or BSC) are also supported and are grouped under the `ethereum` type.
    """  # noqa

    crypto_wallet_id: str
    crypto_wallet_address: str
    crypto_wallet_type: str


class DiscordOAuthFactor(pydantic.BaseModel):
    """
    Fields:
      - id: The unique identifier for the resource.
      - provider_subject: The unique identifier for the user in the identity provider's system, used to link external provider accounts to Stytch members.
      - email_id: The unique ID of a specific email address.
    """  # noqa

    id: str
    provider_subject: str
    email_id: Optional[str] = None


class EmailFactor(pydantic.BaseModel):
    """
    Fields:
      - email_id: The unique ID of a specific email address.
      - email_address: The email address to exchange to.
    """  # noqa

    email_id: str
    email_address: str


class EmbeddableMagicLinkFactor(pydantic.BaseModel):
    embedded_id: str


class FacebookOAuthFactor(pydantic.BaseModel):
    """
    Fields:
      - id: The unique identifier for the resource.
      - provider_subject: The unique identifier for the user in the identity provider's system, used to link external provider accounts to Stytch members.
      - email_id: The unique ID of a specific email address.
    """  # noqa

    id: str
    provider_subject: str
    email_id: Optional[str] = None


class FigmaOAuthFactor(pydantic.BaseModel):
    """
    Fields:
      - id: The unique identifier for the resource.
      - provider_subject: The unique identifier for the user in the identity provider's system, used to link external provider accounts to Stytch members.
      - email_id: The unique ID of a specific email address.
    """  # noqa

    id: str
    provider_subject: str
    email_id: Optional[str] = None


class GitLabOAuthFactor(pydantic.BaseModel):
    """
    Fields:
      - id: The unique identifier for the resource.
      - provider_subject: The unique identifier for the user in the identity provider's system, used to link external provider accounts to Stytch members.
      - email_id: The unique ID of a specific email address.
    """  # noqa

    id: str
    provider_subject: str
    email_id: Optional[str] = None


class GithubOAuthExchangeFactor(pydantic.BaseModel):
    """
    Fields:
      - email_id: The unique ID of a specific email address.
    """  # noqa

    email_id: str


class GithubOAuthFactor(pydantic.BaseModel):
    """
    Fields:
      - id: The unique identifier for the resource.
      - provider_subject: The unique identifier for the user in the identity provider's system, used to link external provider accounts to Stytch members.
      - email_id: The unique ID of a specific email address.
    """  # noqa

    id: str
    provider_subject: str
    email_id: Optional[str] = None


class GoogleOAuthExchangeFactor(pydantic.BaseModel):
    """
    Fields:
      - email_id: The unique ID of a specific email address.
    """  # noqa

    email_id: str


class GoogleOAuthFactor(pydantic.BaseModel):
    """
    Fields:
      - id: The unique identifier for the resource.
      - provider_subject: The unique identifier for the user in the identity provider's system, used to link external provider accounts to Stytch members.
      - email_id: The unique ID of a specific email address.
    """  # noqa

    id: str
    provider_subject: str
    email_id: Optional[str] = None


class HubspotOAuthExchangeFactor(pydantic.BaseModel):
    """
    Fields:
      - email_id: The unique ID of a specific email address.
    """  # noqa

    email_id: str


class HubspotOAuthFactor(pydantic.BaseModel):
    """
    Fields:
      - id: The unique identifier for the resource.
      - provider_subject: The unique identifier for the user in the identity provider's system, used to link external provider accounts to Stytch members.
      - email_id: The unique ID of a specific email address.
    """  # noqa

    id: str
    provider_subject: str
    email_id: Optional[str] = None


class ImpersonatedFactor(pydantic.BaseModel):
    """
    Fields:
      - impersonator_id: For impersonated sessions initiated via the Stytch Dashboard, the impersonator_id will be the impersonator's Stytch Dashboard member_id.
      - impersonator_email_address: The email address of the impersonator.
    """  # noqa

    impersonator_id: str
    impersonator_email_address: str


class InstagramOAuthFactor(pydantic.BaseModel):
    """
    Fields:
      - id: The unique identifier for the resource.
      - provider_subject: The unique identifier for the user in the identity provider's system, used to link external provider accounts to Stytch members.
      - email_id: The unique ID of a specific email address.
    """  # noqa

    id: str
    provider_subject: str
    email_id: Optional[str] = None


class JWK(pydantic.BaseModel):
    kty: str
    use: str
    key_ops: List[str]
    alg: str
    kid: str
    x5c: List[str]
    x5tS256: str
    n: str
    e: str


class LinkedInOAuthFactor(pydantic.BaseModel):
    """
    Fields:
      - id: The unique identifier for the resource.
      - provider_subject: The unique identifier for the user in the identity provider's system, used to link external provider accounts to Stytch members.
      - email_id: The unique ID of a specific email address.
    """  # noqa

    id: str
    provider_subject: str
    email_id: Optional[str] = None


class MicrosoftOAuthFactor(pydantic.BaseModel):
    """
    Fields:
      - id: The unique identifier for the resource.
      - provider_subject: The unique identifier for the user in the identity provider's system, used to link external provider accounts to Stytch members.
      - email_id: The unique ID of a specific email address.
    """  # noqa

    id: str
    provider_subject: str
    email_id: Optional[str] = None


class OAuthAccessTokenExchangeFactor(pydantic.BaseModel):
    """
    Fields:
      - client_id: The ID of the client.
    """  # noqa

    client_id: str


class OIDCSSOFactor(pydantic.BaseModel):
    """
    Fields:
      - id: The unique identifier for the resource.
      - provider_id: The unique identifier for an identity provider configuration.
      - external_id: An identifier that can be used in API calls wherever a user_id is expected. This is a string consisting of alphanumeric, `.`, `_`, `-`, or `|` characters with a maximum length of 128 characters.
    """  # noqa

    id: str
    provider_id: str
    external_id: str


class PhoneNumberFactor(pydantic.BaseModel):
    """
    Fields:
      - phone_id: The unique ID for the phone number.
      - phone_number: The phone number in E.164 format (i.e. +1XXXXXXXXXX).
    """  # noqa

    phone_id: str
    phone_number: str


class RecoveryCodeFactor(pydantic.BaseModel):
    totp_recovery_code_id: str


class SAMLSSOFactor(pydantic.BaseModel):
    """
    Fields:
      - id: The unique identifier for the resource.
      - provider_id: The unique identifier for an identity provider configuration.
      - external_id: An identifier that can be used in API calls wherever a user_id is expected. This is a string consisting of alphanumeric, `.`, `_`, `-`, or `|` characters with a maximum length of 128 characters.
    """  # noqa

    id: str
    provider_id: str
    external_id: str


class SalesforceOAuthFactor(pydantic.BaseModel):
    """
    Fields:
      - id: The unique identifier for the resource.
      - provider_subject: The unique identifier for the user in the identity provider's system, used to link external provider accounts to Stytch members.
      - email_id: The unique ID of a specific email address.
    """  # noqa

    id: str
    provider_subject: str
    email_id: Optional[str] = None


class ShopifyOAuthFactor(pydantic.BaseModel):
    """
    Fields:
      - id: The unique identifier for the resource.
      - provider_subject: The unique identifier for the user in the identity provider's system, used to link external provider accounts to Stytch members.
      - email_id: The unique ID of a specific email address.
    """  # noqa

    id: str
    provider_subject: str
    email_id: Optional[str] = None


class SlackOAuthExchangeFactor(pydantic.BaseModel):
    """
    Fields:
      - email_id: The unique ID of a specific email address.
    """  # noqa

    email_id: str


class SlackOAuthFactor(pydantic.BaseModel):
    """
    Fields:
      - id: The unique identifier for the resource.
      - provider_subject: The unique identifier for the user in the identity provider's system, used to link external provider accounts to Stytch members.
      - email_id: The unique ID of a specific email address.
    """  # noqa

    id: str
    provider_subject: str
    email_id: Optional[str] = None


class SnapchatOAuthFactor(pydantic.BaseModel):
    """
    Fields:
      - id: The unique identifier for the resource.
      - provider_subject: The unique identifier for the user in the identity provider's system, used to link external provider accounts to Stytch members.
      - email_id: The unique ID of a specific email address.
    """  # noqa

    id: str
    provider_subject: str
    email_id: Optional[str] = None


class SpotifyOAuthFactor(pydantic.BaseModel):
    """
    Fields:
      - id: The unique identifier for the resource.
      - provider_subject: The unique identifier for the user in the identity provider's system, used to link external provider accounts to Stytch members.
      - email_id: The unique ID of a specific email address.
    """  # noqa

    id: str
    provider_subject: str
    email_id: Optional[str] = None


class SteamOAuthFactor(pydantic.BaseModel):
    """
    Fields:
      - id: The unique identifier for the resource.
      - provider_subject: The unique identifier for the user in the identity provider's system, used to link external provider accounts to Stytch members.
      - email_id: The unique ID of a specific email address.
    """  # noqa

    id: str
    provider_subject: str
    email_id: Optional[str] = None


class TikTokOAuthFactor(pydantic.BaseModel):
    """
    Fields:
      - id: The unique identifier for the resource.
      - provider_subject: The unique identifier for the user in the identity provider's system, used to link external provider accounts to Stytch members.
      - email_id: The unique ID of a specific email address.
    """  # noqa

    id: str
    provider_subject: str
    email_id: Optional[str] = None


class TrustedAuthTokenFactor(pydantic.BaseModel):
    """
    Fields:
      - token_id: The ID of the trusted auth token.
    """  # noqa

    token_id: str


class TwitchOAuthFactor(pydantic.BaseModel):
    """
    Fields:
      - id: The unique identifier for the resource.
      - provider_subject: The unique identifier for the user in the identity provider's system, used to link external provider accounts to Stytch members.
      - email_id: The unique ID of a specific email address.
    """  # noqa

    id: str
    provider_subject: str
    email_id: Optional[str] = None


class TwitterOAuthFactor(pydantic.BaseModel):
    """
    Fields:
      - id: The unique identifier for the resource.
      - provider_subject: The unique identifier for the user in the identity provider's system, used to link external provider accounts to Stytch members.
      - email_id: The unique ID of a specific email address.
    """  # noqa

    id: str
    provider_subject: str
    email_id: Optional[str] = None


class WebAuthnFactor(pydantic.BaseModel):
    """
    Fields:
      - webauthn_registration_id: Globally unique UUID that identifies a Passkey or WebAuthn registration in the Stytch API. The `webauthn_registration_id` is used when you need to operate on a specific User's WebAuthn registration.
      - domain: The domain for Passkeys or WebAuthn. Defaults to `window.location.hostname`.
      - user_agent: The user agent of the client.
    """  # noqa

    webauthn_registration_id: str
    domain: str
    user_agent: Optional[str] = None


class YahooOAuthFactor(pydantic.BaseModel):
    """
    Fields:
      - id: The unique identifier for the resource.
      - provider_subject: The unique identifier for the user in the identity provider's system, used to link external provider accounts to Stytch members.
      - email_id: The unique ID of a specific email address.
    """  # noqa

    id: str
    provider_subject: str
    email_id: Optional[str] = None


class AuthenticationFactor(pydantic.BaseModel):
    """
    Fields:
      - type: The type or category of the resource, method, or entity.
      - delivery_method: The method that should be used to verify a member's new email address. The options are `EMAIL_MAGIC_LINK` or `EMAIL_OTP`. This field is optional, if no value is provided, `EMAIL_MAGIC_LINK` will be used.
      - last_authenticated_at: The timestamp when the member last successfully authenticated.
      - created_at: The timestamp indicating when the resource was created.
      - updated_at: The timestamp indicating when the resource was last updated.
      - email_factor: An authentication factor object representing email-based authentication (magic links or OTP).
      - phone_number_factor: An authentication factor object representing SMS-based phone number authentication.
      - google_oauth_factor: An authentication factor object representing Google OAuth authentication.
      - microsoft_oauth_factor: An authentication factor object representing Microsoft OAuth authentication.
      - apple_oauth_factor: An authentication factor object representing Apple OAuth authentication.
      - webauthn_factor: An authentication factor object representing WebAuthn/passkey authentication.
      - authenticator_app_factor: An authentication factor object representing TOTP authenticator app authentication.
      - github_oauth_factor: An authentication factor object representing GitHub OAuth authentication.
      - recovery_code_factor: An authentication factor object representing recovery code authentication.
      - facebook_oauth_factor: An authentication factor object representing Facebook OAuth authentication.
      - crypto_wallet_factor: An authentication factor object representing Web3 cryptocurrency wallet authentication.
      - amazon_oauth_factor: An authentication factor object representing Amazon OAuth authentication.
      - bitbucket_oauth_factor: An authentication factor object representing Bitbucket OAuth authentication.
      - coinbase_oauth_factor: An authentication factor object representing Coinbase OAuth authentication.
      - discord_oauth_factor: An authentication factor object representing Discord OAuth authentication.
      - figma_oauth_factor: An authentication factor object representing Figma OAuth authentication.
      - git_lab_oauth_factor: An authentication factor object representing GitLab OAuth authentication.
      - instagram_oauth_factor: An authentication factor object representing Instagram OAuth authentication.
      - linked_in_oauth_factor: An authentication factor object representing LinkedIn OAuth authentication.
      - shopify_oauth_factor: An authentication factor object representing Shopify OAuth authentication.
      - slack_oauth_factor: An authentication factor object representing Slack OAuth authentication.
      - snapchat_oauth_factor: An authentication factor object representing Snapchat OAuth authentication.
      - spotify_oauth_factor: An authentication factor object representing Spotify OAuth authentication.
      - steam_oauth_factor: An authentication factor object representing Steam OAuth authentication.
      - tik_tok_oauth_factor: An authentication factor object representing TikTok OAuth authentication.
      - twitch_oauth_factor: An authentication factor object representing Twitch OAuth authentication.
      - twitter_oauth_factor: An authentication factor object representing Twitter OAuth authentication.
      - embeddable_magic_link_factor: An authentication factor object representing embeddable magic link authentication.
      - biometric_factor: An authentication factor object representing biometric authentication (fingerprint, face, etc.).
      - saml_sso_factor: An authentication factor object representing SAML SSO authentication.
      - oidc_sso_factor: An authentication factor object representing OIDC (OpenID Connect) SSO authentication.
      - salesforce_oauth_factor: An authentication factor object representing Salesforce OAuth authentication.
      - yahoo_oauth_factor: An authentication factor object representing Yahoo OAuth authentication.
      - hubspot_oauth_factor: An authentication factor object representing HubSpot OAuth authentication.
      - slack_oauth_exchange_factor: An authentication factor object representing Slack OAuth token exchange authentication.
      - hubspot_oauth_exchange_factor: An authentication factor object representing HubSpot OAuth token exchange.
      - github_oauth_exchange_factor: An authentication factor object representing GitHub OAuth token exchange.
      - google_oauth_exchange_factor: An authentication factor object representing Google OAuth token exchange.
      - impersonated_factor: An authentication factor object indicating that authentication was performed via impersonation.
      - oauth_access_token_exchange_factor: An authentication factor object representing OAuth access token exchange.
      - trusted_auth_token_factor: An authentication factor object representing authentication via a trusted third-party token.
    """  # noqa

    type: AuthenticationFactorType
    delivery_method: AuthenticationFactorDeliveryMethod
    last_authenticated_at: Optional[datetime.datetime] = None
    created_at: Optional[datetime.datetime] = None
    updated_at: Optional[datetime.datetime] = None
    email_factor: Optional[EmailFactor] = None
    phone_number_factor: Optional[PhoneNumberFactor] = None
    google_oauth_factor: Optional[GoogleOAuthFactor] = None
    microsoft_oauth_factor: Optional[MicrosoftOAuthFactor] = None
    apple_oauth_factor: Optional[AppleOAuthFactor] = None
    webauthn_factor: Optional[WebAuthnFactor] = None
    authenticator_app_factor: Optional[AuthenticatorAppFactor] = None
    github_oauth_factor: Optional[GithubOAuthFactor] = None
    recovery_code_factor: Optional[RecoveryCodeFactor] = None
    facebook_oauth_factor: Optional[FacebookOAuthFactor] = None
    crypto_wallet_factor: Optional[CryptoWalletFactor] = None
    amazon_oauth_factor: Optional[AmazonOAuthFactor] = None
    bitbucket_oauth_factor: Optional[BitbucketOAuthFactor] = None
    coinbase_oauth_factor: Optional[CoinbaseOAuthFactor] = None
    discord_oauth_factor: Optional[DiscordOAuthFactor] = None
    figma_oauth_factor: Optional[FigmaOAuthFactor] = None
    git_lab_oauth_factor: Optional[GitLabOAuthFactor] = None
    instagram_oauth_factor: Optional[InstagramOAuthFactor] = None
    linked_in_oauth_factor: Optional[LinkedInOAuthFactor] = None
    shopify_oauth_factor: Optional[ShopifyOAuthFactor] = None
    slack_oauth_factor: Optional[SlackOAuthFactor] = None
    snapchat_oauth_factor: Optional[SnapchatOAuthFactor] = None
    spotify_oauth_factor: Optional[SpotifyOAuthFactor] = None
    steam_oauth_factor: Optional[SteamOAuthFactor] = None
    tik_tok_oauth_factor: Optional[TikTokOAuthFactor] = None
    twitch_oauth_factor: Optional[TwitchOAuthFactor] = None
    twitter_oauth_factor: Optional[TwitterOAuthFactor] = None
    embeddable_magic_link_factor: Optional[EmbeddableMagicLinkFactor] = None
    biometric_factor: Optional[BiometricFactor] = None
    saml_sso_factor: Optional[SAMLSSOFactor] = None
    oidc_sso_factor: Optional[OIDCSSOFactor] = None
    salesforce_oauth_factor: Optional[SalesforceOAuthFactor] = None
    yahoo_oauth_factor: Optional[YahooOAuthFactor] = None
    hubspot_oauth_factor: Optional[HubspotOAuthFactor] = None
    slack_oauth_exchange_factor: Optional[SlackOAuthExchangeFactor] = None
    hubspot_oauth_exchange_factor: Optional[HubspotOAuthExchangeFactor] = None
    github_oauth_exchange_factor: Optional[GithubOAuthExchangeFactor] = None
    google_oauth_exchange_factor: Optional[GoogleOAuthExchangeFactor] = None
    impersonated_factor: Optional[ImpersonatedFactor] = None
    oauth_access_token_exchange_factor: Optional[OAuthAccessTokenExchangeFactor] = None
    trusted_auth_token_factor: Optional[TrustedAuthTokenFactor] = None


class Session(pydantic.BaseModel):
    """
    Fields:
      - session_id: Globally unique UUID that identifies a specific Session in the Stytch API.
      - user_id: The unique ID for a User. When making API calls, you may use an `external_id` in place of the `user_id` if one is set for the User.
      - authentication_factors: A list of authentication factors used during the session, including type, timestamp, and delivery method.
      - roles: Roles to explicitly assign to this Member.
    See the [RBAC guide](https://stytch.com/docs/guides/rbac/role-assignment) for more information about role assignment.
      - started_at: The timestamp when the session or process was initiated.
      - last_accessed_at: The timestamp when the session was last accessed or refreshed.
      - expires_at: The timestamp indicating when the session, token, lock, or other resource will expire.
      - attributes: Provided attributes to help with fraud detection. These values are pulled and passed into Stytch endpoints by your application.
      - custom_claims: A JSON object containing custom claims to include in tokens or sessions.
    """  # noqa

    session_id: str
    user_id: str
    authentication_factors: List[AuthenticationFactor]
    roles: List[str]
    started_at: Optional[datetime.datetime] = None
    last_accessed_at: Optional[datetime.datetime] = None
    expires_at: Optional[datetime.datetime] = None
    attributes: Optional[Attributes] = None
    custom_claims: Optional[Dict[str, Any]] = None


class AttestResponse(ResponseBase):
    """Response type for `Sessions.attest`.
    Fields:
      - user_id: The unique ID for a User. When making API calls, you may use an `external_id` in place of the `user_id` if one is set for the User.
      - session_token: The `session_token` associated with a User's existing Session.
      - session_jwt: The JSON Web Token (JWT) associated with a User's existing Session.
      - user: The `user` object affected by this API call.
      - session: If you initiate a Session, by including `session_duration_minutes` in your authenticate call, you'll receive a full Session object in the response.
      - user_device: If a valid `telemetry_id` was passed in the request and the Fingerprint Lookup API returned results, this field will contain information about the user's device attributes.
    """  # noqa

    user_id: str
    session_token: str
    session_jwt: str
    user: User
    session: Optional[Session] = None
    user_device: Optional[DeviceInfo] = None


class AuthenticateResponse(ResponseBase):
    """Response type for `Sessions.authenticate`.
    Fields:
      - session: If you initiate a Session, by including `session_duration_minutes` in your authenticate call, you'll receive a full Session object in the response.
      - session_token: The `session_token` associated with a User's existing Session.
      - session_jwt: The JSON Web Token (JWT) associated with a User's existing Session.
      - user: The `user` object affected by this API call.
      - verdict: The result of an authorization check, indicating whether the member is authorized to perform the requested action.
    """  # noqa

    session: Session
    session_token: str
    session_jwt: str
    user: User
    verdict: Optional[AuthorizationVerdict] = None


class ExchangeAccessTokenResponse(ResponseBase):
    """Response type for `Sessions.exchange_access_token`.
    Fields:
      - user_id: The unique ID for a User. When making API calls, you may use an `external_id` in place of the `user_id` if one is set for the User.
      - session_token: The `session_token` associated with a User's existing Session.
      - session_jwt: The JSON Web Token (JWT) associated with a User's existing Session.
      - user: The `user` object affected by this API call.
      - session: If you initiate a Session, by including `session_duration_minutes` in your authenticate call, you'll receive a full Session object in the response.
      - user_device: If a valid `telemetry_id` was passed in the request and the Fingerprint Lookup API returned results, this field will contain information about the user's device attributes.
    """  # noqa

    user_id: str
    session_token: str
    session_jwt: str
    user: User
    session: Optional[Session] = None
    user_device: Optional[DeviceInfo] = None


class GetJWKSResponse(ResponseBase):
    """Response type for `Sessions.get_jwks`.
    Fields:
      - keys: Cryptographic keys used for signing, encryption, or verification.
    """  # noqa

    keys: List[JWK]


class GetResponse(ResponseBase):
    """Response type for `Sessions.get`.
    Fields:
      - sessions: A list of session objects.
    """  # noqa

    sessions: List[Session]


class MigrateResponse(ResponseBase):
    """Response type for `Sessions.migrate`.
    Fields:
      - user_id: The unique ID for a User. When making API calls, you may use an `external_id` in place of the `user_id` if one is set for the User.
      - session_token: The `session_token` associated with a User's existing Session.
      - session_jwt: The JSON Web Token (JWT) associated with a User's existing Session.
      - user: The `user` object affected by this API call.
      - session: If you initiate a Session, by including `session_duration_minutes` in your authenticate call, you'll receive a full Session object in the response.
      - user_device: If a valid `telemetry_id` was passed in the request and the Fingerprint Lookup API returned results, this field will contain information about the user's device attributes.
    """  # noqa

    user_id: str
    session_token: str
    session_jwt: str
    user: User
    session: Optional[Session] = None
    user_device: Optional[DeviceInfo] = None


class RevokeResponse(ResponseBase):
    """Response type for `Sessions.revoke`.
    Fields:
    """  # noqa


# MANUAL(AuthenticateJWTLocalResponse)(Types)
class AuthenticateJWTLocalResponse(ResponseBase):
    session: Session
    session_jwt: str


# ENDMANUAL(AuthenticateJWTLocalResponse)
